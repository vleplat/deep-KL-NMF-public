This code was downloaded from http://www.lx.it.pt/~bioucas/code.htm 